<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="Tracepaper Tool" />
    <title>Workspace</title>
    <link rel="icon" type="image/x-icon" href="/assets/draftsman-logo.png" />
    <script src="/js/configuration.js"></script>
    <script src="/js/draftsman.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.3/css/bootstrap.min.css"
          integrity="sha512-SbiR/eusphKoMVVXysTKG/7VseWii+Y3FdHrt0EpKgpToZeemhqHeZeLWLhJutz/2ut2Vw1uQEj2MbRF+TVBUA=="
          crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" defer></script>
    <link rel="stylesheet" href="/css/customs.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="/js/custom-form.js"></script>
</head>
<body class="d-flex flex-column h-100" x-data x-import="custom-navbar;
                                                        commands/Project/create;
                                                        utils/advanced-form;
                                                        utils/tables;
                                                        utils/form-modal;
                                                        utils/basic-modal">

<main class="flex-shrink-0">
    <ui-navbar></ui-navbar>
    <br>
    <div class="container data-element" x-data="{data: $store.data.get}"
         @refresh="data = $store.data.get">
        <h1><span x-text="data.name"></span> projects</h1>
        <hr>
        <div class="row">
            <template x-for="item in data.projects">
                <div class="col-lg-4">
                    <div class="card card-custom">
                        <div class="card-body">
                            <h5 class="card-title" x-text="item.name"></h5>
                            <p class="card-text" x-text="item.summary"></p>
                            <a x-bind:href="'/project?drn=' + item.drn" class="btn btn-primary">Open</a>
                        </div>
                    </div>
                </div>
            </template>
            <div class="col-1">
                <div class="card border-light card-custom">
                    <div class="card-body" style="min-height:100px;">
                        <button class="btn btn-success btn-circle btn-xl vertical-center"
                                data-bs-target="#modal_initializeProject"
                                data-bs-toggle="modal" >
                            <i class="fa-solid fa-plus"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <ui-create-project command="initializeProject"></ui-create-project>
    <ui-form-modal
        alias="initializeProject"
        title="Initialize a new project"
        sort-keys="['name','documentation']"
        :pre-fill="{'workspaceDrn' : Draftsman.fetch_query_parameter('drn')}"
        hide="['workspaceDrn']"
    ></ui-form-modal>

    <draftsman-query alias="data" x-include="/prepared-statements/workspace.txt" authenticated>
    </draftsman-query>
</main>
</body>
</html>
